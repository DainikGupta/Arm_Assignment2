;This program is used to find the value of tan(x) for different values of x.
;It makes use of the equation- tan(x)=sin(x)/cos(x).
;Both sin(x) and cos(x) are found differently and then divided to get tan(x).

		AREA    tan,CODE,READONLY
        EXPORT __main
        ENTRY
__main    FUNCTION
		VLDR.F32 S0, =10	;VALUE 0F X
		MOV R1, #50		;NUMBER OF TERMS IN SERIES TO BE CALCULATED,n
		VMOV.F32 S2, #1	;INITIALIZING THE REGISTER TO SAVE THE VALUE OF FACTORIALS.
		VMOV.F32 S5, #1	;INITIALIZING THE REGISTER TO SAVE THE POWER.
		VLDR.F32 S6, =0	;INITIALIZING THE REGISTER TO SAVE THE SUM.
		MOV R2, #1
		MOV R10, #-1	
		MOV R9, #0		;FOR CHECKING EVEN/ODD
		VLDR.F32 S10, =0.0174533	;SAVING THE VALUE OF 1 DEGREE INTO RADIAN 
		VMUL.F32 S0, S0, S10		;CONVERTING DEGREE TO RADIAN
		VMOV.F32 S5, S0
		VLDR.F32 S8, =0			; DIFFERENTIATE BTW SIN AND COS
		B SIN

;THIS FUNCTION WILL BE USED TO CALCULATE THE FACTORIAL OF A NUMBER.
;THE NUMBER WHOSE FACTORIAL IS TO BE CALCULATED WILL BE STORED IN R3.
;THE FACTORIAL WILL BE STORED IN S2.
FACT 	VMOV S3, R3			;MOVING THE VALUE OF CORE REGISTER TO FP REGISTER
		VCVT.F32.U32 S3, S3	;CONVERTING THE FLOATING POINT REGISTER TO DECIMAL NUMBER
		VMUL.F32 S2, S2, S3	;CALCULATING FACTORIAL
		SUB R3, R3, #1		;DECREMENTING n
		CMP R3, #1			
		BGT FACT
		BLE SUM


;THIS FUNCTION IS TO DETERMINE THE TERM WILL BE ADDED OR SUBTRACTED BASED ON IF IT IS EVEN OR ODD.
NEGATE	CMP R9, #1			;1 MEANS ODD, 0 MEANS EVEN
		BEQ ODD
		BNE EVEN

;THIS FUNCTION IS TO NEGATE THE VALUE THAT IS TO BE ADDED.
ODD		SUB R9, R9, #1		;CHANGING REGISTER SO THAT NEXT VALUE WILL BE POSITIVE
		VNEG.F32 S2, S2		;NEGATE STATEMENT
		B FACT				;BRANCH TO FACT

EVEN	ADD R9, R9, #1		;CHANGING REGISTER SO THAT NEXT VALUE WILL BE NEGATIVE
		B FACT				;BRANCH TO FACT


;THIS FUNCTION IS USED TO CALCULATE THE POWERS OF X.
POWER	VMUL.F32 S5, S5, S0		;THIS CREATES *X
		VMUL.F32 S5, S5, S0		;THIS MAKES IT *X^2
		BLX LR
	
	
;THIS FUNCTION IS USED TO CALCULATE THE VALUE OF SIN OR COS
;IT FIRST DETERMINE EACH TERM OF THE EXPANSION SERIES AND THEN ADDS IT TO THE SUM.
SUM	VDIV.F32 S7, S5, S2		;TERM OF THE EXPANSION
		VADD.F32 S6, S6, S7		;ADDING THE TERM TO THE SUM
		BL POWER				;CALCULATING THE POWER OF X FOR THE NEXT TERM.
		VCMP.F32 S8, #0			;COMPARING IF THE EXPANSION SERIES IS FOR SIN OR COS(0 MEANS SIN)
		VMRS APSR_NZCV, FPSCR	;CONVERTING THE FLAG VALUES.
		BEQ SIN					;THIS SHOWS THAT THE SERIES IS FOR SIN
		BNE COS					;THIS SHOWS THAT THE SERIES IS FOR COS
		
;THIS FUNCTION IS USED TO CALCULATE THE VALUE OF SIN OR COS
;IT FIRST DETERMINE EACH TERM OF THE EXPANSION SERIES AND THEN ADDS IT TO THE SUM.
;SUMCOS	VDIV.F32 S7, S5, S2		;TERM OF THE EXPANSION
		VADD.F32 S6, S6, S7		;ADDING THE TERM TO THE SUM
		BL POWER				;CALCULATING THE POWER OF X FOR THE NEXT TERM.
		B COS
		;VCMP.F32 S8, #0			;COMPARING IF THE EXPANSION SERIES IS FOR SIN OR COS(0 MEANS SIN)
		;VMRS APSR_NZCV, FPSCR	;CONVERTING THE FLAG VALUES.
		;BEQ SIN					;THIS SHOWS THAT THE SERIES IS FOR SIN
		;BNE COS					;THIS SHOWS THAT THE SERIES IS FOR COS
		
		
;THIS FUNCTION WILL BE CALCULATING THE SIN(X).
;IT WILL DO THIS BY USING A LOOP.
SIN		ADD R10, R10, #2	;INCREMENT IS BY 2 BECAUSE ALTERNATE POWERS OF X ARE PRESENT IN THE SERIES EXPANSION.
		MOV R3, R10
		VMOV.F32 S2, #1
		CMP R10, R1			;COMPARING FOR THE NUMBER OF TERMS IN THE SERIES.
		BLT NEGATE			;R10-1 NO. OF TERMS
		B COSINI


;THIS FUNCTION IS TO INITIALIZE THE REGISTER VALUES FOR DETERMINING THE COS(X).
COSINI	MOV R9, #1	
		MOV R10, #0
		VMUL.F32 S5, S0, S0		;CALCULATING X^2
		VMOV.F32 S8, S6			;SAVING SIN VALUE
		VCMP.F32 S8, #0
		VMRS APSR_NZCV, FPSCR	
		BEQ PASS
		VMOV.F32 S6, #1			;SUM=1
		B COS					;BRANCHING TO COS

PASS	VMOV.F32 S6, #1
		B TAN
		
		
;THIS FUNCTION IS USED TO CALCULATE COS(X)
COS		ADD R10, R10, #2	;INCREMENT IS BY 2 BECAUSE ALTERNATE POWERS OF X ARE PRESENT IN THE SERIES EXPANSION.
		MOV R3, R10
		VMOV.F32 S2, #1
		CMP R10, R1			;COMPARING FOR THE NUMBER OF TERMS IN THE SERIES.
		BLT NEGATE			;R10 NO. OF TERMS
		B TAN


;THIS FUNCTION IS USED TO FIND THE VALUE OF TAN(X)
TAN		VDIV.F32 S10, S8, S6	;DIVIDING SIN(X) BY COS(X)
		B STOP


;THIS IS USED TO STOP THE EXECUTION
STOP    B STOP
        ENDFUNC
        END